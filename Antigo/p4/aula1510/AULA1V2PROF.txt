;ESTE PROGRAMA INICIA O LCD, POSICIONA NA PRIMEIRA LINHA/COLUNA E MOSTRA AS LETRAS A, B, C SEQUENCIALMENTE
;(VERSÃO PROF FINALIZADA)

#INCLUDE<P16F877A.INC>
INICIO
 BSF  STATUS,RP0   ; CONFIGURAÇÃO DE PORTAS
 BCF  STATUS,RP1
 MOVLW B'11111111'
 MOVWF TRISA
 MOVLW B'00001111'
 MOVWF TRISB
 MOVLW B'11111001'
 MOVWF TRISC
 MOVLW 0X00
 MOVWF TRISD
 MOVWF TRISE
 MOVLW .7
 MOVWF ADCON1      ; DESABILITA ENTRADAS
 
                       ; ANALÓGICAS
 MOVLW B'00000000'
 MOVWF OPTION_REG
 BCF  STATUS,RP0
 CALL ATRASO1   ; TEMPO PARA o LCD LIGAR

LOOP;

 CALL INICIA_LCD
 MOVLW 0X80 		;posiciona o cursor do lcd par a aprimeira posição
 CALL ESCREVE_COMANDO

 MOVLW 'A'
 CALL ESCREVE_DADO	;escreve a letra A

 MOVLW 'B'
 CALL ESCREVE_DADO	;escreve a letra B

 MOVLW 'C'
 CALL ESCREVE_DADO	;escreve a letra C 
 
GOTO LOOP

ESCREVE_COMANDO        ; ENVIA COMANDO AO LCD
 BCF  PORTE,0    ; SINAL DE COMANDO
 NOP
 MOVWF PORTD     ; INFORMAÇÃO NA PORTA D
 NOP
 NOP
 BSF  PORTE,1   ; PULSO DE ENABLE
 NOP
 NOP
 BCF  PORTE,1
 CALL ATRASO1   ; ATRASO DE 1 mS
 RETURN

ESCREVE_DADO           ; ESCREVE CARACTERES NO LCD
 BSF  PORTE,0    ; SINAL DE DADO (CARACTER)
 NOP
 MOVWF PORTD   ; INFORMAÇÃO NA PORTA D
 NOP
 NOP
 BSF  PORTE,1   ;PULSO DE ENABLE
 NOP
 NOP
 BCF  PORTE,1
 CALL ATRASO1   ; ATRASO DE 1mS
 RETURN

INICIA_LCD         ; CONFIGURAÇÃO INCIAL DO LCD
 MOVLW 0X38
 CALL ESCREVE_COMANDO
 CALL ATRASO1  ;NECESSITA DE 3 MS DE ATRASO
 CALL ATRASO1
 CALL ATRASO1
 MOVLW 0X38
 CALL ESCREVE_COMANDO
 MOVLW 0X0C
 CALL ESCREVE_COMANDO 
 MOVLW 0X06
 CALL ESCREVE_COMANDO
 MOVLW 0X01
 CALL ESCREVE_COMANDO
 CALL ATRASO_1MS
 RETURN

ATRASO1
MOVLW .250 ;W RECEBE 250
MOVWF REG1 ;REG1 RECEBE 250
VOLTA1
DECF REG1,F ;REG1 RECEBE REG1 -1
BTFSS STATUS,Z ;Pula a proxima instrucao se Z for 1
GOTO VOLTA1 ;Pula para Volta1 
RETURN 
 
END

